<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrador</title>
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>

<script>
// Si no hay token -> al login
if (!localStorage.getItem("token") || localStorage.getItem("role") !== "administrador") {
    window.location.href = "index.html";
}
</script>

<header class="header">
    <h2>Panel de Administraci칩n</h2>
    <button onclick="logout()">Cerrar Sesi칩n</button>
</header>

<main class="container">

    <!-- ========================== -->
    <!-- REGISTRO DE USUARIO NUEVO -->
    <!-- ========================== -->
    <section class="card">
        <h3>Registrar Usuario</h3>

        <input id="reg-name" type="text" placeholder="Nombre">
        <input id="reg-email" type="email" placeholder="Correo">
        <input id="reg-pass" type="password" placeholder="Contrase침a">

        <select id="reg-role">
            <option value="gestor">Gestor</option>
            <option value="administrador">Administrador</option>
        </select>

        <button onclick="registerUser()">Registrar</button>
        <p id="reg-msg"></p>
    </section>

    <!-- ========================== -->
    <!-- TABLA DE USUARIOS -->
    <!-- ========================== -->
    <section class="card">
        <h3>Usuarios Registrados</h3>

        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Email</th>
                    <th>Rol</th>
                    <th>Acciones</th>
                </tr>
            </thead>

            <tbody id="users-table-body">
            </tbody>
        </table>

    </section>

</main>

<!-- ================================================== -->
<!-- MODAL EDITAR USUARIO -->
<!-- ================================================== -->
<div id="edit-box" class="modal">
    <div class="modal-content">
        <h3>Editar Usuario</h3>

        <input id="edit-id" type="hidden">
        <input id="edit-name" type="text">
        <input id="edit-email" type="email">

        <button onclick="updateUser()">Guardar Cambios</button>
        <button onclick="document.getElementById('edit-box').style.display='none'">Cerrar</button>
    </div>
</div>

<!-- ================================================== -->
<!-- MODAL CAMBIAR ROL -->
<!-- ================================================== -->
<div id="role-box" class="modal">
    <div class="modal-content">
        <h3>Cambiar Rol</h3>

        <input id="role-id" type="hidden">

        <select id="new-role">
            <option value="gestor">Gestor</option>
            <option value="administrador">Administrador</option>
        </select>

        <button onclick="updateRole()">Guardar Rol</button>
        <button onclick="document.getElementById('role-box').style.display='none'">Cerrar</button>
    </div>
</div>

<script src="js/app.js"></script>
<script>
// Cargar usuarios autom치ticamente
getUsers();
</script>

</body>
</html>

